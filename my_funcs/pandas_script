import pandas as pd


def check_length(value):
    s = str(value)
    return len(s)


def check_is_digit(value):
    s = str(value)
    return s.isdigit()


def save_to_xls(path, dict_rename, actual_columns):
    df = pd.read_excel(path)
    df.dropna(inplace=True)
    df.rename(columns=dict_rename, inplace=True)
    df[necessary_columns[2]] = df[necessary_columns[1]].map(check_length).sort_values()
    df[necessary_columns[3]] = df[necessary_columns[1]].map(check_is_digit).sort_values(
        ascending=False)
    df2 = df[actual_columns]
    df2.to_excel('ERM.xlsx')


def outpute_to_console(path, dict_rename, actual_columns):
    df = pd.read_excel(path)
    df.dropna(inplace=True)
    df.rename(columns=dict_rename, inplace=True)
    ch = df[necessary_columns[1]].map(check_length).sort_values()
    ch2 = df[necessary_columns[1]].map(check_is_digit).sort_values(
        ascending=False)
    return ch, ch2


rename_columns = {'Unnamed: 0': "Номер заказа", 'Unnamed: 5': "ИЛС/Внутренний номер"}
necessary_columns = ["Номер заказа", "ИЛС/Внутренний номер", "Кол-во символов в ЛС",
                     "Проверка is_digit: ЛС включает только цифры"]
save_to_xls('Заявки-CDR_общий_01.01.2024.xls', rename_columns, necessary_columns)
print(outpute_to_console('Заявки-CDR_общий_01.01.2024.xls', rename_columns, necessary_columns))
